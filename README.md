# Text-to-Image for Fashion Collection Generation

## Цели проекта

- **Быстрота:** Генерация 500 изображений занимает не месяцы, а примерно 1 час.
- **Экономия:** Меньше затрат на фотосессии и работу дизайнеров.
- **Автоматизация:** Модель генерирует картинки без постоянной ручной доработки.
- **Персонализация:** Изображения точно соответствуют запросам пользователей, что повышает их вовлечённость.

---

## Что в проекте

**Бизнес-требования:**
- Пользователь вводит текстовое описание (например, "красное платье с кружевом").
- Сервис генерирует изображение в пределах тематики одежды, обуви и аксессуаров.
- Время генерации – не более 1 минуты (на текущем этапе).

**Ограничения:**
- На старте – только для футболок, платьев, штанов, леггинсов и обуви.
- Мало дизайнеров (до 3) для проверки, поэтому модель должна работать «из коробки».

---

## Структура кода Baseline

- **config.py:**  
  Хранит все основные настройки: пути к данным, параметры обучения, размеры изображений, настройки GAN (например, размер входного шума, коэффициенты обучения и т.д.).

- **datasets.py:**  
  Загружает и обрабатывает данные. Здесь:
  - Используется датасет [DeepFashion-MultiModal](https://github.com/yumingj/DeepFashion-MultiModal).
  - Фильтруются изображения, загружаются текстовые описания и эмбеддинги.
  
- **get_embeddings.py:**  
  Генерирует эмбеддинги для текстовых описаний с помощью SentenceTransformer. Результаты сохраняются в виде pickle-файла.

- **main.py:**  
  Главный скрипт для запуска обучения и инференса.  
  - Настраивает параметры (например, размер изображения, режим обучения/тестирования).
  - Загружает данные и запускает тренировку GAN или режим генерации.

- **model.py:**  
  Определяет архитектуру GAN:
  - Генератор (Stage1_G, Stage2_G) и дискриминатор (Stage1_D, Stage2_D).
  - Модель строится так, чтобы сначала генерировать базовое изображение, а затем его улучшать.

- **utils.py:**  
  Вспомогательные функции:
  - Инициализация весов.
  - Сохранение результатов (изображения, модели).
  - Расчет ошибок (например, функция для расчёта KL-расстояния).

---

## Как запустить Baseline

1. **Настройка:**
   - Склонируйте репозиторий.
   - Проверьте и настройте параметры в `config.py` (например, путь к данным, настройки GPU).

2. **Получение эмбеддингов:**
   - Запустите `get_embeddings.py`, чтобы создать эмбеддинги для текстовых описаний.

3. **Обучение:**
   - Запустите `main.py` в режиме обучения:
     ```sh
     python main.py --train y --data_dir путь_к_данным --stage 1
     ```
   - Модель начнет обучение и сохранит промежуточные результаты.

4. **Генерация изображений:**
   - Запустите `main.py` в режиме тестирования, чтобы сгенерировать изображения.
